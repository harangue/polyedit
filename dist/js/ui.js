(function() {
  var Editor, Ui;

  Editor = require(rootDir + 'editor.js');

  Ui = (function() {
    function Ui(main) {
      this.main = main;
      this.zoom = 1;
      $(window).resize(this.resize);
      this.resize();
    }

    Ui.prototype.startLoading = function(header) {
      switch (header) {
        case 'files':
          return $("#files .header .loader").show();
        case 'sprites':
          return $("#sprites .header .loader").show();
      }
    };

    Ui.prototype.stopLoading = function(header) {
      switch (header) {
        case 'files':
          return $("#files .header .loader").hide();
        case 'sprites':
          return $("#sprites .header .loader").hide();
      }
    };

    Ui.prototype.setEditor = function(sprite) {
      var ref, ref1, zoom;
      if (this.editor) {
        this.editor["delete"]();
      }
      this.editor = new Editor(this.main);
      if ((ref = this.main.data) != null) {
        if ((ref1 = ref.settings) != null) {
          ref1.open = sprite.key;
        }
      }
      $(".sprite-listing").removeClass('editor');
      $(".sprite-listing[data-id=" + sprite.id + "]").addClass('editor');
      $(".tools").show();
      $(".canvas").show().find(".sprite-image").attr('src', sprite.path);
      $(".sprite-image").unbind('load').load((function(_this) {
        return function() {
          var zoom;
          zoom = Math.max(1, Math.min(10, Math.floor($("#editor").width() / $(".sprite-image")[0].naturalWidth * 3 / 4)));
          $(".zoom-box").val(zoom * 100);
          return _this.setZoom(zoom * 100);
        };
      })(this));
      this.editor.start(sprite.data);
      if (this.main.justOpened && this.main.data.settings.zoom) {
        zoom = Math.max(1, Math.min(10, Math.floor($("#editor").width() / $(".sprite-image")[0].naturalWidth * 3 / 4)));
        $(".zoom-box").val(zoom * 100);
        this.setZoom(zoom * 100);
      }
      return this.main.justOpened = false;
    };

    Ui.prototype.setActive = function(sprite) {
      var el;
      el = $(".sprite-listing[data-id=" + sprite.id + "]");
      return el.addClass('activeSprite');
    };

    Ui.prototype.setInactive = function(sprite) {
      var el;
      el = $(".sprite-listing[data-id=" + sprite.id + "]");
      return el.removeClass('activeSprite');
    };

    Ui.prototype.addSprite = function(sprite) {
      var extraClass, match;
      match = _.findWhere(this.main.data.sprites, {
        key: sprite.key
      });
      if (match && match.data) {
        extraClass = "activeSprite";
      } else {
        extraClass = "";
      }
      $("<a />", {
        "href": '#',
        "data-id": sprite.id,
        "class": "list-group-item sprite-listing " + extraClass
      }).append($("<div />", {
        "class": "list-group-item-float"
      }).append($("<img />", {
        "class": 'icon',
        "src": sprite.path
      }))).append($("<div />", {
        "class": "list-group-item-float"
      }).append($("<span />", {
        "class": "title",
        "text": sprite.name
      }))).append($("<div />", {
        "class": 'path',
        "text": sprite.key
      })).appendTo("#sprites .list-group");
      return this.resize();
    };

    Ui.prototype.updateSprite = function(sprite) {
      var el;
      el = $(".sprite-listing[data-id=" + sprite.id + "]");
      el.find(".icon").attr('src', sprite.path);
      el.find(".title").text(sprite.name);
      el.find(".path").text(sprite.key);
      return this.resize();
    };

    Ui.prototype.reset = function() {
      var settings;
      settings = this.main.data.settings;
      $("#sprites .list-group").html('');
      $("#sprites .search-box").val('');
      $("#sprites .active-box").val('off');
      $(".canvas").hide();
      $("#properties .exporter-box").val(settings.exporter);
      $(".left").width(settings.leftWidth);
      $("#properties").width(settings.rightWidth);
      if (settings.zoom) {
        this.setZoom(settings.zoom);
      }
      return this.resize();
    };

    Ui.prototype.resize = function() {
      return $("#editor").width($(".bottom").width() - $(".left").width() - $("#properties").width() - 2);
    };

    Ui.prototype.setZoom = function(zoom) {
      var ref;
      this.main.data.settings.zoom = zoom;
      this.zoom = zoom / 100;
      if ((ref = this.editor) != null) {
        ref.handleZoom();
      }
      $(".sprite-image").width($(".sprite-image")[0].naturalWidth * this.zoom).height($(".sprite-image")[0].naturalHeight * this.zoom);
      return $(".canvas").width($(".sprite-image").width()).height($(".sprite-image").height()).css('background-size', (this.zoom * 2) + "px " + (this.zoom * 2) + "px");
    };

    return Ui;

  })();

  module.exports = Ui;

}).call(this);

//# sourceMappingURL=data:application/json;base64,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QUFGLENBQ0csQ0FBQyxLQURKLENBQ1UsQ0FBQSxDQUFFLGVBQUYsQ0FBbUIsQ0FBQSxDQUFBLENBQUUsQ0FBQyxZQUF0QixHQUFxQyxJQUFDLENBQUEsSUFEaEQsQ0FFRyxDQUFDLE1BRkosQ0FFVyxDQUFBLENBQUUsZUFBRixDQUFtQixDQUFBLENBQUEsQ0FBRSxDQUFDLGFBQXRCLEdBQXNDLElBQUMsQ0FBQSxJQUZsRDthQUlBLENBQUEsQ0FBRSxTQUFGLENBQ0csQ0FBQyxLQURKLENBQ1UsQ0FBQSxDQUFFLGVBQUYsQ0FBa0IsQ0FBQyxLQUFuQixDQUFBLENBRFYsQ0FFRyxDQUFDLE1BRkosQ0FFVyxDQUFBLENBQUUsZUFBRixDQUFrQixDQUFDLE1BQW5CLENBQUEsQ0FGWCxDQUdHLENBQUMsR0FISixDQUdRLGlCQUhSLEVBRzZCLENBQUMsSUFBQyxDQUFBLElBQUQsR0FBTSxDQUFQLENBQUEsR0FBUyxLQUFULEdBQWEsQ0FBQyxJQUFDLENBQUEsSUFBRCxHQUFNLENBQVAsQ0FBYixHQUFzQixJQUhuRDtJQVRNOzs7Ozs7RUFjWixNQUFNLENBQUMsT0FBUCxHQUFpQjtBQXRJakIiLCJmaWxlIjoidWkuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyJFZGl0b3IgPSByZXF1aXJlKHJvb3REaXIrJ2VkaXRvci5qcycpXG5cbmNsYXNzIFVpXG4gICBjb25zdHJ1Y3RvcjogKEBtYWluKSAtPlxuICAgICAgQHpvb20gPSAxXG4gICAgICAkKHdpbmRvdykucmVzaXplIEByZXNpemVcbiAgICAgIEByZXNpemUoKVxuXG4gICBzdGFydExvYWRpbmc6IChoZWFkZXIpIC0+XG4gICAgICBzd2l0Y2ggaGVhZGVyXG4gICAgICAgICB3aGVuICdmaWxlcycgdGhlbiAkKFwiI2ZpbGVzIC5oZWFkZXIgLmxvYWRlclwiKS5zaG93KClcbiAgICAgICAgIHdoZW4gJ3Nwcml0ZXMnIHRoZW4gJChcIiNzcHJpdGVzIC5oZWFkZXIgLmxvYWRlclwiKS5zaG93KClcblxuICAgc3RvcExvYWRpbmc6IChoZWFkZXIpIC0+XG4gICAgICBzd2l0Y2ggaGVhZGVyXG4gICAgICAgICB3aGVuICdmaWxlcycgdGhlbiAkKFwiI2ZpbGVzIC5oZWFkZXIgLmxvYWRlclwiKS5oaWRlKClcbiAgICAgICAgIHdoZW4gJ3Nwcml0ZXMnIHRoZW4gJChcIiNzcHJpdGVzIC5oZWFkZXIgLmxvYWRlclwiKS5oaWRlKClcblxuICAgc2V0RWRpdG9yOiAoc3ByaXRlKSAtPlxuICAgICAgaWYgQGVkaXRvciB0aGVuIEBlZGl0b3IuZGVsZXRlKClcbiAgICAgIEBlZGl0b3IgPSBuZXcgRWRpdG9yIEBtYWluXG5cbiAgICAgIEBtYWluLmRhdGE/LnNldHRpbmdzPy5vcGVuID0gc3ByaXRlLmtleVxuXG4gICAgICAkKFwiLnNwcml0ZS1saXN0aW5nXCIpLnJlbW92ZUNsYXNzKCdlZGl0b3InKVxuICAgICAgJChcIi5zcHJpdGUtbGlzdGluZ1tkYXRhLWlkPSN7c3ByaXRlLmlkfV1cIikuYWRkQ2xhc3MoJ2VkaXRvcicpXG5cbiAgICAgICQoXCIudG9vbHNcIikuc2hvdygpXG4gICAgICAkKFwiLmNhbnZhc1wiKVxuICAgICAgICAgLnNob3coKVxuICAgICAgICAgLmZpbmQoXCIuc3ByaXRlLWltYWdlXCIpLmF0dHIoJ3NyYycsIHNwcml0ZS5wYXRoKVxuXG4gICAgICAkKFwiLnNwcml0ZS1pbWFnZVwiKVxuICAgICAgICAgLnVuYmluZCgnbG9hZCcpXG4gICAgICAgICAubG9hZCA9PlxuICAgICAgICAgICAgem9vbSA9IE1hdGgubWF4KCAxLCBNYXRoLm1pbigxMCwgTWF0aC5mbG9vcigkKFwiI2VkaXRvclwiKS53aWR0aCgpIC8gJChcIi5zcHJpdGUtaW1hZ2VcIilbMF0ubmF0dXJhbFdpZHRoICogMyAvIDQpICkgKVxuICAgICAgICAgICAgJChcIi56b29tLWJveFwiKS52YWwoem9vbSoxMDApXG4gICAgICAgICAgICBALnNldFpvb20oem9vbSoxMDApXG5cbiAgICAgIEBlZGl0b3Iuc3RhcnQgc3ByaXRlLmRhdGFcblxuICAgICAgaWYgQG1haW4uanVzdE9wZW5lZCBhbmQgQG1haW4uZGF0YS5zZXR0aW5ncy56b29tXG4gICAgICAgICB6b29tID0gTWF0aC5tYXgoIDEsIE1hdGgubWluKDEwLCBNYXRoLmZsb29yKCQoXCIjZWRpdG9yXCIpLndpZHRoKCkgLyAkKFwiLnNwcml0ZS1pbWFnZVwiKVswXS5uYXR1cmFsV2lkdGggKiAzIC8gNCkgKSApXG4gICAgICAgICAkKFwiLnpvb20tYm94XCIpLnZhbCh6b29tKjEwMClcbiAgICAgICAgIEAuc2V0Wm9vbSh6b29tKjEwMClcblxuICAgICAgQG1haW4uanVzdE9wZW5lZCA9IGZhbHNlXG5cbiAgIHNldEFjdGl2ZTogKHNwcml0ZSkgLT5cbiAgICAgIGVsID0gJChcIi5zcHJpdGUtbGlzdGluZ1tkYXRhLWlkPSN7c3ByaXRlLmlkfV1cIilcbiAgICAgIGVsLmFkZENsYXNzKCdhY3RpdmVTcHJpdGUnKVxuXG4gICBzZXRJbmFjdGl2ZTogKHNwcml0ZSkgLT5cbiAgICAgIGVsID0gJChcIi5zcHJpdGUtbGlzdGluZ1tkYXRhLWlkPSN7c3ByaXRlLmlkfV1cIilcbiAgICAgIGVsLnJlbW92ZUNsYXNzKCdhY3RpdmVTcHJpdGUnKVxuXG4gICBhZGRTcHJpdGU6IChzcHJpdGUpIC0+XG4gICAgICBtYXRjaCA9IF8uZmluZFdoZXJlIEBtYWluLmRhdGEuc3ByaXRlcywge2tleTogc3ByaXRlLmtleX1cbiAgICAgIGlmIG1hdGNoIGFuZCBtYXRjaC5kYXRhIHRoZW4gZXh0cmFDbGFzcyA9IFwiYWN0aXZlU3ByaXRlXCIgZWxzZSBleHRyYUNsYXNzID0gXCJcIlxuXG4gICAgICAkKFwiPGEgLz5cIiwge1xuICAgICAgICAgXCJocmVmXCI6ICcjJyxcbiAgICAgICAgIFwiZGF0YS1pZFwiOiBzcHJpdGUuaWRcbiAgICAgICAgIFwiY2xhc3NcIjogXCJsaXN0LWdyb3VwLWl0ZW0gc3ByaXRlLWxpc3RpbmcgI3tleHRyYUNsYXNzfVwiXG4gICAgICB9KVxuICAgICAgICAgLmFwcGVuZChcbiAgICAgICAgICAgICQoXCI8ZGl2IC8+XCIsIHtcbiAgICAgICAgICAgICAgIFwiY2xhc3NcIjogXCJsaXN0LWdyb3VwLWl0ZW0tZmxvYXRcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hcHBlbmQgJChcIjxpbWcgLz5cIiwge1xuICAgICAgICAgICAgICAgXCJjbGFzc1wiOiAnaWNvbicsXG4gICAgICAgICAgICAgICBcInNyY1wiOiBzcHJpdGUucGF0aFxuICAgICAgICAgICAgfSlcbiAgICAgICAgIClcblxuICAgICAgICAgLmFwcGVuZChcbiAgICAgICAgICAgICQoXCI8ZGl2IC8+XCIsIHtcbiAgICAgICAgICAgICAgIFwiY2xhc3NcIjogXCJsaXN0LWdyb3VwLWl0ZW0tZmxvYXRcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hcHBlbmQgJChcIjxzcGFuIC8+XCIsIHtcbiAgICAgICAgICAgICAgIFwiY2xhc3NcIjogXCJ0aXRsZVwiXG4gICAgICAgICAgICAgICBcInRleHRcIjogc3ByaXRlLm5hbWVcbiAgICAgICAgICAgIH0pXG4gICAgICAgICApXG4gICAgICAgICAuYXBwZW5kICQoXCI8ZGl2IC8+XCIsIHtcbiAgICAgICAgICAgIFwiY2xhc3NcIjogJ3BhdGgnLFxuICAgICAgICAgICAgXCJ0ZXh0XCI6IHNwcml0ZS5rZXlcbiAgICAgICAgIH0pXG4gICAgICAgICAuYXBwZW5kVG8oXCIjc3ByaXRlcyAubGlzdC1ncm91cFwiKVxuXG4gICAgICBAcmVzaXplKClcblxuICAgdXBkYXRlU3ByaXRlOiAoc3ByaXRlKSAtPlxuICAgICAgZWwgPSAkKFwiLnNwcml0ZS1saXN0aW5nW2RhdGEtaWQ9I3tzcHJpdGUuaWR9XVwiKVxuICAgICAgZWwuZmluZChcIi5pY29uXCIpLmF0dHIoJ3NyYycsIHNwcml0ZS5wYXRoKVxuICAgICAgZWwuZmluZChcIi50aXRsZVwiKS50ZXh0KHNwcml0ZS5uYW1lKVxuICAgICAgZWwuZmluZChcIi5wYXRoXCIpLnRleHQoc3ByaXRlLmtleSlcblxuICAgICAgQHJlc2l6ZSgpXG5cbiAgIHJlc2V0OiAoKSAtPlxuICAgICAgc2V0dGluZ3MgPSBAbWFpbi5kYXRhLnNldHRpbmdzXG5cbiAgICAgICQoXCIjc3ByaXRlcyAubGlzdC1ncm91cFwiKS5odG1sKCcnKVxuICAgICAgJChcIiNzcHJpdGVzIC5zZWFyY2gtYm94XCIpLnZhbCgnJylcbiAgICAgICQoXCIjc3ByaXRlcyAuYWN0aXZlLWJveFwiKS52YWwoJ29mZicpXG5cbiAgICAgICQoXCIuY2FudmFzXCIpLmhpZGUoKVxuXG4gICAgICAkKFwiI3Byb3BlcnRpZXMgLmV4cG9ydGVyLWJveFwiKS52YWwoc2V0dGluZ3MuZXhwb3J0ZXIpXG5cbiAgICAgICQoXCIubGVmdFwiKS53aWR0aCBzZXR0aW5ncy5sZWZ0V2lkdGhcbiAgICAgICQoXCIjcHJvcGVydGllc1wiKS53aWR0aCBzZXR0aW5ncy5yaWdodFdpZHRoXG5cbiAgICAgIGlmIHNldHRpbmdzLnpvb20gdGhlbiBAc2V0Wm9vbSBzZXR0aW5ncy56b29tXG4gICAgICBAcmVzaXplKClcblxuICAgcmVzaXplOiAoKSAtPlxuICAgICAgJChcIiNlZGl0b3JcIikud2lkdGgoJChcIi5ib3R0b21cIikud2lkdGgoKSAtICQoXCIubGVmdFwiKS53aWR0aCgpIC0gJChcIiNwcm9wZXJ0aWVzXCIpLndpZHRoKCkgLSAyKVxuXG4gICBzZXRab29tOiAoem9vbSkgLT5cbiAgICAgIEBtYWluLmRhdGEuc2V0dGluZ3Muem9vbSA9IHpvb21cbiAgICAgIEB6b29tID0gem9vbS8xMDBcbiAgICAgIEBlZGl0b3I/LmhhbmRsZVpvb20oKVxuXG4gICAgICAkKFwiLnNwcml0ZS1pbWFnZVwiKVxuICAgICAgICAgLndpZHRoKCQoXCIuc3ByaXRlLWltYWdlXCIpWzBdLm5hdHVyYWxXaWR0aCAqIEB6b29tKVxuICAgICAgICAgLmhlaWdodCgkKFwiLnNwcml0ZS1pbWFnZVwiKVswXS5uYXR1cmFsSGVpZ2h0ICogQHpvb20pXG5cbiAgICAgICQoXCIuY2FudmFzXCIpXG4gICAgICAgICAud2lkdGgoJChcIi5zcHJpdGUtaW1hZ2VcIikud2lkdGgoKSlcbiAgICAgICAgIC5oZWlnaHQoJChcIi5zcHJpdGUtaW1hZ2VcIikuaGVpZ2h0KCkpXG4gICAgICAgICAuY3NzKCdiYWNrZ3JvdW5kLXNpemUnLCBcIiN7QHpvb20qMn1weCAje0B6b29tKjJ9cHhcIilcblxubW9kdWxlLmV4cG9ydHMgPSBVaVxuIl19